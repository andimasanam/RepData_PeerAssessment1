---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---
library(ggplot2)
library(scales)
library(Hmisc)

## Loading and preprocessing the data

1. Load the activity data using read.csv 
# Clear the work space
```{r}
rm(list=ls())
```
# Load the raw activity data
```{r}
if(!file.exists('activity.csv')){
    unzip('activity.zip')
}
activityData <- read.csv('activity.csv')
```

2. Transform the data if needed for analysis
```{r}
activity_raw$date <- as.POSIXct(activity_raw$date, format="%Y-%m-%d")
```
# Compute the weekdays from the date attribute
```{r}
activity_raw <- data.frame(date=activity_raw$date, 
                           weekday=tolower(weekdays(activity_raw$date)), 
                           steps=activity_raw$steps, 
                           interval=activity_raw$interval)
```
# Compute the day type (weekend or weekday)
```{r}
activity_raw <- cbind(activity_raw, 
                      daytype=ifelse(activity_raw$weekday == "saturday" | 
                                     activity_raw$weekday == "sunday", "weekend", 
                                     "weekday"))
```
# Create the final data.frame
```{r}
activity <- data.frame(date=activity_raw$date, 
                       weekday=activity_raw$weekday, 
                       daytype=activity_raw$daytype, 
                       interval=activity_raw$interval,
                       steps=activity_raw$steps)
```
# Clear the workspace
```{r}
rm(activity_raw) 
```
Display the first few rows of the activity data frame:
```{r}
head(activity)
```

## What is mean total number of steps taken per day?
1. Make a histogram of the total number of steps taken each day
# Compute the total number of steps each day (NA values removed)
```{r}
sum_data <- aggregate(activity$steps, by=list(activity$date), FUN=sum, na.rm=TRUE)
```
# Rename the attributes
```{r}
names(sum_data) <- c("date", "total")
```
Display the first few rows of the sum_data data frame:
```{r}
head(sum_data)
```
The histogram is given by the following lines of code:
# Compute the histogram of the total number of steps each day
```{r}
hist(sum_data$total, 
     breaks=seq(from=0, to=25000, by=2500),
     col="green", 
     xlab="Total number of steps", 
     ylim=c(0, 20), 
     main="Histogram of the total number of steps taken each day\n(NA removed)")
```
2. Calculate and report the mean and median total number of steps taken per day
```{r}
mean(sum_data$total)
median(sum_data$total)
```

## What is the average daily activity pattern?
averageStepsPerTimeBlock <- aggregate(x=list(meanSteps=activityData$steps), by=list(interval=activityData$interval), FUN=mean, na.rm=TRUE)
1. Make a time series plot
ggplot(data=averageStepsPerTimeBlock, aes(x=interval, y=meanSteps)) +
    geom_line() +
    xlab("5-minute interval") +
    ylab("average number of steps taken") 
2. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
mostSteps <- which.max(averageStepsPerTimeBlock$meanSteps)
timeMostSteps <-  gsub("([0-9]{1,2})([0-9]{2})", "\\1:\\2", averageStepsPerTimeBlock[mostSteps,'interval'])


## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
